getOption(pack)
library(rstudioapi)
wd = dirname(rstudioapi::getSourceEditorContext()$path)
meta = read.delim(paste0(wd, "/NCI_TPW_metadata.tsv"), header = TRUE, sep = "\t")
untreated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
treated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
ic50 = readRDS(paste0(wd, "/NegLogGI50.RDS"))
basalexp = readRDS(paste0(wd, "/CCLE_basalexpression.RDS"))
copynumber = readRDS(paste0(wd, "/CCLE_copynumber.RDS"))
mutations = readRDS(paste0(wd, "/CCLE_mutations.RDS"))
cellline = read.delim(paste0(wd, "/cellline_annotation.tsv"), header = TRUE, sep = "\t")
drug = read.delim(paste0(wd, "/drug_annotation.tsv"), header = TRUE, sep = "\t")
library(rstudioapi)
wd = dirname(rstudioapi::getSourceEditorContext()$path)
meta = read.delim(paste0(wd, "/NCI_TPW_metadata.tsv"), header = TRUE, sep = "\t")
untreated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
treated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
ic50 = readRDS(paste0(wd, "/NegLogGI50.RDS"))
basalexp = readRDS(paste0(wd, "/CCLE_basalexpression.RDS"))
copynumber = readRDS(paste0(wd, "/CCLE_copynumber.RDS"))
mutations = readRDS(paste0(wd, "/CCLE_mutations.RDS"))
cellline = read.delim(paste0(wd, "/cellline_annotation.tsv"), header = TRUE, sep = "\t")
drug = read.delim(paste0(wd, "/drug_annotation.tsv"), header = TRUE, sep = "\t")
head(untreated)
library(rstudioapi)
wd = dirname(rstudioapi::getSourceEditorContext()$path)
meta = read.delim(paste0(wd, "/NCI_TPW_metadata.tsv"), header = TRUE, sep = "\t")
untreated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
treated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
ic50 = readRDS(paste0(wd, "/NegLogGI50.RDS"))
basalexp = readRDS(paste0(wd, "/CCLE_basalexpression.RDS"))
copynumber = readRDS(paste0(wd, "/CCLE_copynumber.RDS"))
mutations = readRDS(paste0(wd, "/CCLE_mutations.RDS"))
cellline = read.delim(paste0(wd, "/cellline_annotation.tsv"), header = TRUE, sep = "\t")
drug = read.delim(paste0(wd, "/drug_annotation.tsv"), header = TRUE, sep = "\t")
apply(treated, 1, funkction(x) {sum(is.na(x))})
apply(treated, 1, funkction(x) {sum(is.na(x))})}
apply(treated, 1, funkction(x) sum(is.na(x))})
apply(treated, 1, function(x) {
sum(is.na(x))
apply(treated, 1, function(x) {
sum(is.na(x))
rmv.rows = apply(treated, 1, function(x) {
sum(is.na(x))
library(rstudioapi)
wd = dirname(rstudioapi::getSourceEditorContext()$path)
meta = read.delim(paste0(wd, "/NCI_TPW_metadata.tsv"), header = TRUE, sep = "\t")
untreated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
treated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
ic50 = readRDS(paste0(wd, "/NegLogGI50.RDS"))
basalexp = readRDS(paste0(wd, "/CCLE_basalexpression.RDS"))
copynumber = readRDS(paste0(wd, "/CCLE_copynumber.RDS"))
mutations = readRDS(paste0(wd, "/CCLE_mutations.RDS"))
cellline = read.delim(paste0(wd, "/cellline_annotation.tsv"), header = TRUE, sep = "\t")
drug = read.delim(paste0(wd, "/drug_annotation.tsv"), header = TRUE, sep = "\t")
rmv.rows = apply(dat, 1, function(x) {
sum(is.na(x))
})
rmv.rows = apply(treated, 1, function(x) {
sum(is.na(x))
})
rmv.rows[1:20]
nrow(treated)
which(rmv.rows>0)
rmv.rows[20:100]
which(rmv.rows > 0)
View(treated)
rmv.rows = apply(basalexp, 1, function(x) {
sum(is.na(x))
})
which(rmv.rows > 0)
View(cellline)
View(copynumber)
View(drug)
View(meta)
View(mutations)
View(treated)
View(untreated)
View(cellline)
rmv.rows = apply(cellline, 1, function(x) {
sum(is.na(x))
})
which(rmv.rows > 0)
rmv.basal.na = apply(basalexo, 1, function(x) {
sum(is.na(x))
})
rmv.basal.na = apply(basalexp, 1, function(x) {
sum(is.na(x))
})
which(rmv.basal.na>0)
View(basalexp)
which(rmv.basal.na > 0)
library(rstudioapi)
wd = dirname(rstudioapi::getSourceEditorContext()$path)
meta = read.delim(paste0(wd, "/NCI_TPW_metadata.tsv"), header = TRUE, sep = "\t")
untreated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
treated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
ic50 = readRDS(paste0(wd, "/NegLogGI50.RDS"))
basalexp = readRDS(paste0(wd, "/CCLE_basalexpression.RDS"))
copynumber = readRDS(paste0(wd, "/CCLE_copynumber.RDS"))
mutations = readRDS(paste0(wd, "/CCLE_mutations.RDS"))
cellline = read.delim(paste0(wd, "/cellline_annotation.tsv"), header = TRUE, sep = "\t")
drug = read.delim(paste0(wd, "/drug_annotation.tsv"), header = TRUE, sep = "\t")
na.treated = apply(treated, 1, function(x) {
sum(is.na(x))
})
which(na.treated > 0)
na.untreated = apply(untreated, 1, function(x) {
sum(is.na(x))
})
which(na.untreated >0)
na.mutations = apply(mutations, 1, function(x) {
sum(is.na(x))
})
which(na.mutations > 0)
View(mutations)
na.mutations = apply(mutations, 2, function(x) {
sum(is.na(x))
})
na.mutations[12:13]
mutations[, -which(na.mutations > 0)]
head(mutations)
na.mutations[12:13]
na.mutations = na.mutations(, -which(na.mutations >0))
mutations = na.mutations(, -which(na.mutations >0))
mutations = na.mutations[, -which(na.mutations > 0)]
na.mutations
rm(na.mutations)
mutations= mutations[,-12:13]
mutations= mutations[,-(12:13)]
View(mutations)
library(rstudioapi)
wd = dirname(rstudioapi::getSourceEditorContext()$path)
meta = read.delim(paste0(wd, "/NCI_TPW_metadata.tsv"), header = TRUE, sep = "\t")
untreated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
treated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
ic50 = readRDS(paste0(wd, "/NegLogGI50.RDS"))
basalexp = readRDS(paste0(wd, "/CCLE_basalexpression.RDS"))
copynumber = readRDS(paste0(wd, "/CCLE_copynumber.RDS"))
mutations = readRDS(paste0(wd, "/CCLE_mutations.RDS"))
cellline = read.delim(paste0(wd, "/cellline_annotation.tsv"), header = TRUE, sep = "\t")
drug = read.delim(paste0(wd, "/drug_annotation.tsv"), header = TRUE, sep = "\t")
na.treated = apply(treated, 1, function(x) {
+     sum(is.na(x))
+ })
> which(na.treated > 0)
na.treated = apply(treated, 1, function(x) {
sum(is.na(x))
})
which(na.treated > 0)
na.untreated = apply(untreated, 1, function(x) {
sum(is.na(x))
})
which(na.untreated >0)
na.mutations = apply(mutations, 1, function(x) {
sum(is.na(x))
})
which(na.mutations >0)
na.treated = apply(treated, 1, function(x) {sum(is.na(x))})
which(na.treated > 0)
na.untreated = apply(untreated, 1, function(x) {sum(is.na(x))})
which(na.untreated > 0)
na.mutations = apply(mutations, 1, function(x) {sum(is.na(x))})
which(na.mutations > 0)
View(mutations)
view(copynumber)
View(cellline)
View(ic50)
library(rstudioapi)
wd = dirname(rstudioapi::getSourceEditorContext()$path)
meta = read.delim(paste0(wd, "/NCI_TPW_metadata.tsv"), header = TRUE, sep = "\t")
untreated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
treated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
ic50 = readRDS(paste0(wd, "/NegLogGI50.RDS"))
basalexp = readRDS(paste0(wd, "/CCLE_basalexpression.RDS"))
copynumber = readRDS(paste0(wd, "/CCLE_copynumber.RDS"))
mutations = readRDS(paste0(wd, "/CCLE_mutations.RDS"))
cellline = read.delim(paste0(wd, "/cellline_annotation.tsv"), header = TRUE, sep = "\t")
drug = read.delim(paste0(wd, "/drug_annotation.tsv"), header = TRUE, sep = "\t")
na.treated = apply(treated, 2, function(x) {sum(is.na(x))})
which(na.treated > 0)
na.untreated = apply(untreated, 2, function(x) {sum(is.na(x))})
which(na.untreated > 0)
na.mutations = apply(mutations, 2, function(x) {sum(is.na(x))})
which(na.mutations > 0)
na.basal=apply(basalexp, 2, function(x) {sum(is.na(x))})
which(na.basal > 0)
na.cellline=apply(cellline, 2, function(x) {sum(is.na(x))})
which(na.cellline>0)
na.copynumber=apply(copynumber, 2, function(x) {sum(is.na(x))})
which(na.copynumber > 0)
na.ic50=apply(ic50, 2, function(x) {sum(is.na(x))})
which(ic50 > 0)
na.meta=apply(meta, 2, function(x) {sum(is.na(x))})
which(na.meta >0)
mutations.removed = mutations[, -(12:13)]
View(treated)
treated.cisplatin = treated(,-(1:95))
treated.cisplatin <- treated(,-(1:95))
treated.cisplatin <- treated[,-(1:95)]
treated.cisplatin <- treated[,-(151:819)]
View(treated.cisplatin)
treated.cisplatin <- treated[,-(150)]
View(treated.cisplatin)
treated.cisplatin = treated[,-(1:50)]
View(treated.cisplatin)
rm(treated.cisplatin)
treated.cisplatin = treated[,-(1:95)]
rm(treated.cisplatin)
treated.cisplatin = treated[,-(1:94)]
treated.cisplatin = treated[,-(151:725)]
View(treated.cisplatin)
rm(treated.cisplatin)
treated.cisplatin = treated[,-(1:94)]
treated.cisplatin = treated.cisplatin[,-(151:725)]
treated.cisplatin = treated.cisplatin[,-(55:150)]
View(treated.cisplatin)
rm(treated.cisplatin)
treated.cisplatin = treated[,-(1:94)]
View(treated.cisplatin)
treated.cisplatin = treated.cisplatin[,-(56:725)]
View(treated.cisplatin)
untreated.cisplatin = untreated[,-(1:94)]
View(untreated.cisplatin)
untreated.cisplatin = untreated.cisplatin[,-(56:725)]
dim(untreated.cisplatin)
dim(treated.cisplatin)
FC.cisplatin = log2(untreated.cisplatin/treated.cisplatin)
View(FC.cisplatin)
rm(Fc.Cisplatin)
rm(FC.cisplatin)
FC = log2(untreated.cisplatin)
View(FC)
FC = log2(untreated.cisplatin) - log2(treated.cisplatin)
View(FC)
View(treated.cisplatin)
View(untreated.cisplatin)
View(treated.cisplatin)
View(treated)
View(untreated)
rm(untreated.cisplatin)
untreated.cisplatin = untreated[,-(1:94)]
untreated.cisplatin = untreated.cisplatin[,-(56:725)]
rm(FC)
FC= log2(untreated.cisplatin) - log2(treated.cisplatin)
View(FC)
View(treated)
rm(treated.cisplatin)
treated.cisplatin = treated[,-(1:94)]
View(treated.cisplatin)
treated.cisplatin = treated.cisplatin[,1(56:725)]
treated.cisplatin = treated.cisplatin[,-(56:725)]
library(rstudioapi)
wd = dirname(rstudioapi::getSourceEditorContext()$path)
meta = read.delim(paste0(wd, "/NCI_TPW_metadata.tsv"), header = TRUE, sep = "\t")
untreated = readRDS(paste0(wd, "/NCI_TPW_gep_untreated.RDS"))
treated = readRDS(paste0(wd, "/NCI_TPW_gep_treated.RDS"))
ic50 = readRDS(paste0(wd, "/NegLogGI50.RDS"))
basalexp = readRDS(paste0(wd, "/CCLE_basalexpression.RDS"))
copynumber = readRDS(paste0(wd, "/CCLE_copynumber.RDS"))
mutations = readRDS(paste0(wd, "/CCLE_mutations.RDS"))
cellline = read.delim(paste0(wd, "/cellline_annotation.tsv"), header = TRUE, sep = "\t")
drug = read.delim(paste0(wd, "/drug_annotation.tsv"), header = TRUE, sep = "\t")
na.treated = apply(treated, 2, function(x) {sum(is.na(x))})
which(na.treated > 0)
na.untreated = apply(untreated, 2, function(x) {sum(is.na(x))})
which(na.untreated > 0)
na.mutations = apply(mutations, 2, function(x) {sum(is.na(x))})
which(na.mutations > 0)
na.basal=apply(basalexp, 2, function(x) {sum(is.na(x))})
which(na.basal > 0)
na.cellline=apply(cellline, 2, function(x) {sum(is.na(x))})
which(na.cellline>0)
na.copynumber=apply(copynumber, 2, function(x) {sum(is.na(x))})
which(na.copynumber > 0)
na.ic50=apply(ic50, 2, function(x) {sum(is.na(x))})
which(ic50 > 0)
na.meta=apply(meta, 2, function(x) {sum(is.na(x))})
which(na.meta >0)
mutations.removed = mutations[, -(12:13)]
basal.scaled <-- scale(basalexp)
treated.scaled <-- scale(treated)
untreated.scaled <-- scale(untreated)
log2FC.treated.untreated <-- log2(treated.scaled/untreated.scaled)
is.nan.data.frame <- function(x)      #NaN durch 0 ersetzen
do.call(cbind, lapply(x, is.nan))
log2FC.treated.untreated[is.nan(log2FC.treated.untreated)] <- 0
plot(density(log2FC.treated.untreated))
PCA.FC <- prcomp(log2FC.treated.untreated, center=F , scale.=F)
plot(PCA.FC, type ="lines")
plot(PCA.FC$rotation[, 1], PCA.FC$rotation[, 2], xlab = "PC1", ylab = "PC2")
# Medikamente einfärben
chemo <-- c(94:248)
FC.named <-- log2FC.treated.untreated
colnames(FC.named)[chemo] <-- "chemo"
chemo <-- c(94:248)
FC.named <-- log2FC.treated.untreated
colnames(FC.named)[chemo] <-- "chemo"
chemo <-- c(248:94)
chemo <-- c(-(94:248))
FC.named <-- log2FC.treated.untreated
colnames(FC.named)[chemo] <-- "chemo"
colnames(FC.named)[chemo] <- "chemo"
color.chemo <- ifelse(colnames(FC.named)=="chemo", "firebrick","forestgreen")
plot(PCA.FC$rotation[, 1], PCA.FC$rotation[, 2], col = color.chemo[, 1], pch = 19, xlab = "PC1",
ylab = "PC2")
plot(PCA.FC$rotation[, 1], PCA.FC$rotation[, 2], col = color.chemo, pch = 19, xlab = "PC1",
ylab = "PC2")
chemo <-- c(-(94:248, 307:533, 589:760))
chemo <-- c(-(94:248 307:533 589:760))
chemo <-- c(-(94:248; 307:533 ;589:760))
chemo1 <-- c(-(94:248))
chemo2 <-- c(307:533)
chemo3 <-- c(589:760)
chemo1
chemo2
chemo <-- cbind(chemo1, chemo2, chemo3)
chemo <-- cbind(chemo1, chemo2, chemo3, deparse.level = 1)
chemo <-- c(chemo1, chemo2, chemo3)
FC.named <-- log2FC.treated.untreated
colnames(FC.named)[chemo] <- "chemo"
color.chemo <- ifelse(colnames(FC.named)=="chemo", "firebrick","forestgreen")
plot(PCA.FC$rotation[, 1], PCA.FC$rotation[, 2], col = color.chemo, pch = 19, xlab = "PC1",
+      ylab = "PC2")
chemo1 <-- c(-(94:248))
chemo2 <-- c(-(307:533))
chemo3 <-- c(-(589:760))
chemo <-- c(chemo1, chemo2, chemo3)
FC.named <-- log2FC.treated.untreated
colnames(FC.named)[chemo] <- "chemo"
color.chemo <- ifelse(colnames(FC.named)=="chemo", "firebrick","forestgreen")
plot(PCA.FC$rotation[, 1], PCA.FC$rotation[, 2], col = color.chemo, pch = 19, xlab = "PC1",
+      ylab = "PC2")
plot(PCA.FC$rotation[, 1], PCA.FC$rotation[, 2], col = color.chemo, pch = 19, xlab = "PC1",
+      ylab = "PC2")
chemo
chemo1 <-- c(94:248))
chemo2 <-- c(307:533))
chemo3 <-- c(589:760))
chemo1 <-- c(94:248)
chemo2 <-- c(307:533)
chemo3 <-- c(589:760)
chemo <-- c(chemo1, chemo2, chemo3)
chemo
chemo1 <-- c(94:248)
chemo2 <-- c(307:533)
chemo3 <-- c(589:760)
chemo <-- c(chemo1, chemo2, chemo3)
FC.named <-- log2FC.treated.untreated
colnames(FC.named)[chemo] <- "chemo"
color.chemo <- ifelse(colnames(FC.named)=="chemo", "firebrick","forestgreen")
plot(PCA.FC$rotation[, 1], PCA.FC$rotation[, 2], col = color.chemo, pch = 19, xlab = "PC1",
+      ylab = "PC2")
plot(PCA.FC$rotation[, 1], PCA.FC$rotation[, 2], col=color.chemo, pch = 19, xlab = "PC1",
+      ylab = "PC2")
plot(PCA.FC$rotation[, 1], PCA.FC$rotation[, 2], col=color.chemo, xlab = "PC1", ylab = "PC2")
