treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_labels = c("blue= upregulation", "red = downregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#checking if clustering was successful
wss = sapply(2:7, function(k) {
kmeans(x = t(double.biomarker.FC), centers = k)$tot.withinss
})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
#different version of the heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_labels = c("blue= upregulation", "red = downregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
View(double.biomarker.FC)
summary(double.biomarker.FC)
range(double.biomarker.FC)
#different version of the heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-11:10)
legend_labels = c("blue= upregulation", "red = downregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#different version of the heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-11:10),
legend_labels = c("blue= upregulation", "red = downregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#different version of the heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-3:3),
legend_labels = c("blue= upregulation","","","","","", "red = downregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#different version of the heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-3:3),
legend_labels = c("blue= upregulation","","","","","","","", "red = downregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#different version of the heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-4:4),
legend_labels = c("blue= upregulation","","","","","","","", "red = downregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#different version of the heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-3:3),
legend_labels = c("blue= upregulation","","","","", "red = downregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#different version of the heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-3:3),
legend_labels = c("blue= upregulation","","","","","","red = downregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#different version of the heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red= downregulation","","","","","","blue= upregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
colfunc(25)
heatmap.2(double.biomarker.FC,
dendrogram = "both",
col = colfunc(25),
scale="column",
margins=c(6,10),
xlab= "celllines",
ylab ="biomarker for cisplatin",
labCol = FALSE,
trace = "none",
key =TRUE,
keysize = 0.5,
density.info = "histogram",
key.title = "red = downregulation, blue =upregulation",
key.ylab = "count",
lmat=rbind( c(0, 3), c(2,1), c(0,4) ),
lhei = c(0.2,0.5,0.2))
title("Influence of cisplatin on the biomarkers gene expression", line =10)
#heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red= downregulation","","","","","","blue= upregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#checking if number of cluster is accurate (elbow plot)
wss = sapply(2:7, function(k) {
kmeans(x = t(double.biomarker.FC), centers = k)$tot.withinss
})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
#heatmap variante 1
colfunc2 <- colorRampPalette(c("firebrick2", "grey88", "deepskyblue3"))
colfunc2(3)
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "red= deletation, blue = amplification")
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-1:1)
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "red= deletation, blue = amplification")
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-1:1),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "red= deletation, blue = amplification")
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "red= deletation, blue = amplification")
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
#checking if number of cluster is accurate (elbow plot)
wss = sapply(2:7, function(k) {
kmeans(x = t(copynumber.biomarker), centers = k)$tot.withinss
})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
kmeans(x = t(copynumber.biomarker), centers = 4, nstart = 10)
#heatmap variante 1
colfunc2 <- colorRampPalette(c("firebrick2", "grey88", "deepskyblue3"))
colfunc2(3)
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
kmeans_k = 4,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
#heatmap variante 1
colfunc2 <- colorRampPalette(c("firebrick2", "grey88", "deepskyblue3"))
colfunc2(3)
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
callback = function(hc, copynumber.quali){
sv = svd(t(copynumber.quali))$v[,1]
dend = reorder(as.dendrogram(hc), wts = sv)
as.hclust(dend)
}
pheatmap(test, clustering_callback = callback)
callback = function(hc, copynumber.quali){
sv = svd(t(copynumber.quali))$v[,1]
dend = reorder(as.dendrogram(hc), wts = sv)
as.hclust(dend)
}
pheatmap(copynumber.quali, clustering_callback = callback)
callback = function(hc, copynumber.quali){
sv = svd(t(copynumber.quali))$v[,1]
dend = reorder(as.dendrogram(hc), wts = sv)
as.hclust(dend)
}
pheatmap(copynumber.quali,
color = colfunc2(3),
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
callback = function(hc, copynumber.quali) {
sv = svd(t(copynumber.quali))$v[,1]
dend = reorder(as.dendrogram(hc), wts = sv)
as.hclust(dend)
}
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
callback = function(hc, copynumber.quali) {
sv = svd(t(copynumber.quali))$v[,1]
dend = reorder(as.dendrogram(hc), wts = sv)
as.hclust(dend)
}
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
#heatmap variante 1
colfunc2 <- colorRampPalette(c("firebrick2", "grey88", "deepskyblue3"))
colfunc2(3)
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "row",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
#heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red= downregulation","","","","","","blue= upregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
#checking if number of cluster is accurate (elbow plot)
wss = sapply(2:7, function(k) {
kmeans(x = t(double.biomarker.FC), centers = k)$tot.withinss
})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
#checking if number of cluster is accurate (elbow plot)
wss = sapply(2:7, function(k) {
kmeans(x = t(double.biomarker.FC), centers = k)$tot.withinss
})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
#checking if number of cluster is accurate (elbow plot)
wss = sapply(2:8, function(k) {
kmeans(x = t(double.biomarker.FC), centers = k)$tot.withinss
})
plot(2:8, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
#heatmap variante 1
colfunc2 <- colorRampPalette(c("firebrick2", "grey88", "deepskyblue3"))
colfunc2(3)
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
quantiles = as.matrix(quantile(copynumber.biomarker))
plot(density(copynumber.biomarker))
abline(v= quantiles[c(2,4),1], col= c("red", "blue"), lty =2)
copynumber.quali = ifelse(copynumber.biomarker < (quantiles[2,1]), (-1), ifelse (copynumber.biomarker > (quantiles[4,1]), 1, 0))
View(quantiles)
#heatmap variante 1
colfunc2 <- colorRampPalette(c("firebrick2", "grey88", "deepskyblue3"))
colfunc2(3)
pheatmap(copynumber.quali,
color = colfunc2(3),
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_method = "ward.D2",
legend = TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red=deletion","","","", "", "", "blue=amplification"),
scale = "column",
border_color = "white",
show_colnames = FALSE,
main =  "Connection between biomarker and gene alterations")
#checking the optimal number of cluster (elbow plot)
wss = sapply(2:7, function(k) {
kmeans(x = t(copynumber.biomarker), centers = k)$tot.withinss
})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
kmeans(x = t(copynumber.biomarker), centers = 4, nstart = 10)
# ttest to verify significance of the biomarker
#Creating seperated matrices containing cisplatin
treated.cisplatin <- treated.scaled[,grep ("cisplatin", colnames(treated.scaled))]
untreated.cisplatin <- untreated.scaled[,grep("cisplatin", colnames(treated.scaled))]
# 1. checking normality example BBS9
qqnorm(treated.cisplatin["BBS9", ], main = "BBS9")
qqline(treated.cisplatin["BBS9", ])
# 2. Welch two sample t-test
pvalues.welch <- sapply(double.biomarker, function(x){
t.test(treated.cisplatin[x,], untreated.cisplatin[x,],paired= T)$p.value
})
# 3. Wlicoxon rank sum test
pvalues.wilcoxon <- sapply(double.biomarker, function(x){
wilcox.test(treated.cisplatin[x,], untreated.cisplatin[x,],paired= T)$p.value
})
# Comparison t-tests
cbind(pvalues.welch, pvalues.wilcoxon)
#heatmap
pheatmap(double.biomarker.FC,
color = colfunc(25),
cluster_cols = TRUE,
clustering_rows = TRUE,
clustering_method ="ward.D2",
treeheight_row = 20,
treeheight_col = 30,
legend =TRUE,
legend_breaks = c(-3:3),
legend_labels = c("red= downregulation","","","","","","blue= upregulation"),
show_colnames = FALSE,
cutree_rows = 2,
cutree_cols = 5,
border_color = "white",
scale = "column",
main = "Influence of cisplatin on the biomarkers gene expression")
