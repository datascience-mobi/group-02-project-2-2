---
title: "4. Further Analysis"
output:
  html_document: default
  pdf_document: default
---
<div style="text-align: justify">The goal of the "Further Analysis" was to analyze the RGES values obtained before. Therefore we compared the values from different tissues and different drugs. </div>

<br/>

## Table of contents

1. [Overview of our results](#overview)  
  1.1 [Quantiles](#quantiles)  
  1.2 [Plotting all RGES values from cisplatin](#boxplot)  
2. [Mean of RGES from cisplatin in different tissues](#meantissues)  
3. [Mean of RGES for different drugs](#meandrugs)  
  3.1 [Distribution of RGES values from different drugs](#distribution)  
    

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include = FALSE}
results <- readRDS("C:/Users/johan/Documents/Bioinfo_project/results.rds")
``` 

<br/>

### 1. Results overview <a name="overview"></a>

<div style="text-align: justify">A new data frame was computed, which only contains the RGES values for cisplatin. </div>

<br/>

```{r}
results_cisplatin = subset(results , drug == "cisplatin")
```

<br/>

#### 1.1 Quantiles <a name="quantiles"></a>

<br/>

```{r}
quantile(results$RGES)
quantile(results_cisplatin$RGES)
range(results$RGES)
```

```{r, echo = F}
min = min(results$RGES)
max = max(results$RGES)
```


<br/> 

```{r, echo=FALSE, fig.width=4, fig.height=4, out.extra='style="float:center"'}
quantile.res = as.matrix(quantile(results$RGES))
plot(density(results$RGES), main ="Distribution RGES values")
abline(v= quantile.res[c(2,4),1], col= c("red", "blue"), lty =2)
legend(-6, 1.2, legend = c("25 % quantile", "75% quantile"), col = c("red", "blue"), lty = 1:2)
quantile.cis = as.matrix(quantile(results_cisplatin$RGES))
plot(density(results_cisplatin$RGES), main = "Distribution RGES values cisplatin")
abline(v= quantile.cis[c(2,4),1], col= c("red", "blue"), lty =2)
legend(-6, 1.2, legend = c("25 % quantile", "75% quantile"), col = c("red", "blue"), lty = 1:2)
```  

<br/>
  
<div style="text-align: justify">The goal was to find drugs that are able to reverse the cancer induced gene expression. The more negative the RGES the higher the drugs ability to reverse the cancer induced gene expression, therefore negative RGES values were searched. No negative values were computed which indicates a mistake in the code. This is because the computation of signatures and the understanding of the example code took to long. At the end there was no time left to look for mistakes since we needed to continue with the linear regression. Likely causes for the mistake could be the insertion of the data into the code or because of the complex code in general. Another possible cause could be the usage of scaled log2 fold change data as signatures because there was also no time for further research on what values to use. Even though we came so far with the RGES computation we would have needed more than three weeks to fully accomplish the computation.
</div> 

<br/>
<br/>

```{r}
results_neg =results[which(results$RGES < 0),]
results_neg
```

<br/>
<br/>

#### 1.2 Plotting all RGES values of cisplatin <a name="boxplot"></a>
<div style="text-align: justify">To take a look at how our RGES values are distributed, a boxplot with the RGES values for cisplatin in different cell lines was created.  </div>  

<br/>

```{r, echo = FALSE}
boxplot(results_cisplatin$RGES, main = "RGES for cisplatin in different celllines")
```

<br/>

<div style="text-align: justify">You can see that there are only a few outliers, most of the values are concentrated between 0,55 and 0,60 and there are no negative values. That means, that cisplatin does not reverse the cancer induced gene expression at all. </div>

<br/>
<br/>

### 2. Mean RGES values from cisplatin in different tissues <a name="meantissues"></a>
<div style="text-align: justify">To check if cisplatin has the same effect in different tissues, the mean was computed over each type of tissue. There was no striking difference visible.  </div>

<br/>

```{r, echo = FALSE}
tissue = c( "Renal", "Lung" , "Breast" , "Colon", "Prostate" , "Leukemia", "Ovarian", "Melanoma", "CNS")
mean_tissue =sapply(1:length(tissue), function(x) mean(subset(results_cisplatin$RGES , tissue == tissue[x])))
barplot(mean_tissue , name = tissue , las = 2 , horiz = FALSE ,col= "firebrick", border = "white" , main = "mean RGES for cisplatin in different tissues" , ylab = "RGES")
```

<br/>
<br/>

### 3. Mean RGES values for different drugs <a name="meandrugs"></a>
<div style="text-align: justify">Furthermore, the mean RGES values were computed for every drug to check if some drugs might be more efficient in reversing the gene expression. There was no difference visible, so no drug does reverse the gene expression.  </div>

<br/>

```{r, echo=FALSE}
drug = c("5-Azacytidine", "bortezomib", "cisplatin","dasatinib","doxorubicin","erlotinib","geldanamycin","gemcitibine","lapatinib","paclitaxel","sirolimus","sorafenib","sunitinib","topotecan","vorinostat")
mean_drug =sapply(1:length(drug), function(x) mean(subset(results$RGES , drug == drug[x])))
barplot(mean_drug , name = drug , las = 2 , horiz = FALSE ,col= "forestgreen", border = "white" , main = "mean RGES for different drugs" , ylab = "RGES")
```

<br/>
<br/>

#### 3.1 Distribution of RGES values from different drugs
<div style="text-align: justify">To take an intensive look at every drug and its distibution of RGES values, 15 boxplots were computed - one for each drug. The result was, that they looked nearly the same - as the mean RGES values for every drug already indicated. </div>

<br/>

```{r, echo = FALSE}
par(mfrow=c(5,3), mar=c(2,2,2,2))
sapply(1:length(drug),
       function(x) boxplot(results[which(results$drug == drug[x]),2],
                           main = drug[x], 
                           ylim = c(min,max)))
```
